(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[858],{8396:function(e,t,r){Promise.resolve().then(r.bind(r,746))},746:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(7573),a=r(7653),i=r(1695),s=r(6597),o=r(5118),l=r(4522);let u=["만세력(절기) 기준으로 4주8자 계산 중…","사주 오행 분포 분석 중…","부족 오행 보완 점수 산정 중…"];function c(){let e=(0,i.useRouter)(),t=(0,l.T)(e=>e.input),r=(0,l.T)(e=>e.hasHydrated),c=(0,l.T)(e=>e.setSummary),d=(0,l.T)(e=>e.setResults),[m,f]=(0,a.useState)(0),p=t.birth.date.trim().length>0&&t.surnameHanja.trim().length>0;return(0,a.useEffect)(()=>{if(!r)return;if(!p){e.replace("/premium");return}let n=!1,a=setInterval(()=>{f(e=>(e+1)%u.length)},500);return(async()=>{try{let r=(0,o.oj)(t);await new Promise(e=>{setTimeout(e,1700)});let a=await r;if(n)return;c(a.summary),d(a.results),e.replace("/premium/result")}catch(t){if(console.error("[premium/loading] 추천 호출 실패",t),n)return;c(null),d([]),e.replace("/premium")}})(),()=>{n=!0,clearInterval(a)}},[r,p,t,e,d,c]),(0,n.jsx)(s.TdsScreen,{title:"사주 기반으로 분석하고 있어요",description:"잠시만 기다려 주세요.",children:(0,n.jsxs)("div",{className:"loading-wrap",children:[(0,n.jsx)("div",{className:"loading-spinner","aria-label":"로딩 중"}),(0,n.jsx)("p",{className:"loading-text",children:u[m]})]})})}},6597:function(e,t,r){"use strict";r.d(t,{M4:function(){return o},NV:function(){return u},Ob:function(){return l},Sv:function(){return m},TdsBottomCtaDouble:function(){return d},TdsLinkButton:function(){return c},TdsScreen:function(){return i},dE:function(){return s}});var n=r(7573),a=r(8146);function i(e){let{title:t,description:r,titleIconSrc:a,titleIconAlt:i,children:s}=e;return(0,n.jsx)("main",{className:"tds-screen",children:(0,n.jsxs)("section",{className:"tds-panel",children:[t?(0,n.jsx)("h1",{className:"tds-title",children:(0,n.jsxs)("span",{className:"tds-title-row",children:[a?(0,n.jsx)("img",{className:"tds-title-icon",src:a,alt:null!=i?i:"","aria-hidden":!i||void 0}):null,(0,n.jsx)("span",{children:t})]})}):null,r?(0,n.jsx)("p",{className:"tds-description",children:r}):null,s]})})}function s(e){let{label:t,value:r,options:a,onChange:i}=e;return(0,n.jsxs)("div",{className:"tds-field",children:[(0,n.jsx)("span",{className:"tds-label",children:t}),(0,n.jsx)("div",{className:"tds-segmented",role:"tablist","aria-label":t,children:a.map(e=>(0,n.jsx)("button",{type:"button",className:"tds-segmented-option".concat(r===e.value?" is-selected":""),role:"tab","aria-selected":r===e.value,onClick:()=>i(e.value),children:e.label},e.value))})]})}function o(e){let{checked:t,label:r,onChange:a}=e;return(0,n.jsxs)("label",{className:"tds-switch-row",children:[(0,n.jsx)("span",{className:"tds-label",children:r}),(0,n.jsx)("button",{type:"button",role:"switch","aria-checked":t,className:"tds-switch".concat(t?" is-on":""),onClick:()=>a(!t),children:(0,n.jsx)("span",{className:"tds-switch-thumb"})})]})}function l(e){let{children:t,onClick:r,type:a="button",disabled:i=!1}=e;return(0,n.jsx)("button",{type:a,className:"tds-button tds-button-primary",onClick:r,disabled:i,children:(0,n.jsx)("span",{className:"tds-button-label",children:t})})}function u(e){let{children:t,onClick:r,type:a="button",disabled:i=!1}=e;return(0,n.jsx)("button",{type:a,className:"tds-button tds-button-secondary",onClick:r,disabled:i,children:(0,n.jsx)("span",{className:"tds-button-label",children:t})})}function c(e){let{children:t,href:r,variant:i="primary"}=e;return(0,n.jsx)(a.default,{href:r,className:"tds-button ".concat("secondary"===i?"tds-button-secondary":"tds-button-primary"),children:(0,n.jsx)("span",{className:"tds-button-label",children:t})})}function d(e){let{left:t,right:r,topAccessory:a}=e;return(0,n.jsxs)("div",{className:"tds-bottom-cta tds-bottom-cta-double",children:[a?(0,n.jsx)("div",{className:"tds-bottom-cta-top",children:a}):null,(0,n.jsxs)("div",{className:"tds-bottom-cta-actions",children:[(0,n.jsx)("div",{children:t}),(0,n.jsx)("div",{children:r})]})]})}function m(e){let{children:t}=e;return(0,n.jsx)("article",{className:"tds-card",children:t})}},5118:function(e,t,r){"use strict";function n(e){let t=e.startsWith("/")?e:"/".concat(e),r=function(){let e="https://naametoss.vercel.app".trim();return e.endsWith("/")?e.slice(0,-1):e}();return r?"".concat(r).concat(t):t}async function a(e,t){let r=e.trim();if(!r)return{surnameReading:"",options:[],autoSelectedHanja:null};let a=await fetch("".concat(n("/api/surname/options"),"?reading=").concat(encodeURIComponent(r)),{method:"GET",cache:"no-store",signal:t});if(!a.ok){let e=await a.text();throw Error("[api] surname options failed: ".concat(a.status," ").concat(e))}let i=await a.json();if(!(i&&"object"==typeof i&&"string"==typeof i.surnameReading&&Array.isArray(i.options)&&("string"==typeof i.autoSelectedHanja||null===i.autoSelectedHanja)&&i.options.every(e=>!!e&&"object"==typeof e&&"string"==typeof e.hanja&&"boolean"==typeof e.isDefault&&"number"==typeof e.popularityRank&&Number.isFinite(e.popularityRank))))throw Error("[api] invalid surname options response");return i}async function i(e){let t=await fetch(n("/api/recommend/free"),{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw Error("[api] free recommend failed: ".concat(t.status," ").concat(e))}let r=await t.json();if(!function(e){if(!e||"object"!=typeof e)return!1;let t=e.results;return!!Array.isArray(t)&&t.every(e=>!!e&&"object"==typeof e&&"string"==typeof e.nameHangul&&Array.isArray(e.hanjaPair)&&2===e.hanjaPair.length&&"string"==typeof e.hanjaPair[0]&&"string"==typeof e.hanjaPair[1]&&Array.isArray(e.readingPair)&&2===e.readingPair.length&&"string"==typeof e.readingPair[0]&&"string"==typeof e.readingPair[1]&&Array.isArray(e.meaningKwPair)&&2===e.meaningKwPair.length&&"string"==typeof e.meaningKwPair[0]&&"string"==typeof e.meaningKwPair[1]&&"number"==typeof e.score&&Number.isFinite(e.score)&&Array.isArray(e.reasons))}(r))throw Error("[api] invalid response shape");return{results:r.results.slice(0,5)}}async function s(e){let t=await fetch(n("/api/recommend/premium"),{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw Error("[api] premium recommend failed: ".concat(t.status," ").concat(e))}let r=await t.json();if(!function(e){if(!e||"object"!=typeof e||!e.summary||"object"!=typeof e.summary||!Array.isArray(e.results))return!1;let t=e.summary;return!!(("IMPROVE"===t.mode||"HARMONY"===t.mode)&&"string"==typeof t.oneLineSummary&&Array.isArray(t.weakTop2)&&2===t.weakTop2.length&&"boolean"==typeof t.hasHourPillar&&t.pillars&&"object"==typeof t.pillars&&t.distSaju&&"object"==typeof t.distSaju&&Array.isArray(t.distStatus))&&e.results.every(e=>!!e&&"object"==typeof e&&"number"==typeof e.rank&&Number.isFinite(e.rank)&&"string"==typeof e.nameHangul&&Array.isArray(e.hanjaPair)&&2===e.hanjaPair.length&&"string"==typeof e.hanjaPair[0]&&"string"==typeof e.hanjaPair[1]&&Array.isArray(e.readingPair)&&2===e.readingPair.length&&"string"==typeof e.readingPair[0]&&"string"==typeof e.readingPair[1]&&Array.isArray(e.meaningKwPair)&&2===e.meaningKwPair.length&&"string"==typeof e.meaningKwPair[0]&&"string"==typeof e.meaningKwPair[1]&&"number"==typeof e.score&&Number.isFinite(e.score)&&"number"==typeof e.sajuScore5&&Number.isFinite(e.sajuScore5)&&"number"==typeof e.soundScore5&&Number.isFinite(e.soundScore5)&&"number"==typeof e.engineScore01&&Number.isFinite(e.engineScore01)&&Array.isArray(e.why))}(r))throw Error("[api] invalid premium response shape");return{summary:r.summary,results:r.results.slice(0,20)}}async function o(e){let t=await fetch(n("/api/feedback/name"),{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify(e)});if(!t.ok){let e=await t.text();if(503===t.status&&e.includes("Feedback backend is not configured"))return;throw Error("[api] feedback submit failed: ".concat(t.status," ").concat(e))}}async function l(e){let t=Array.from(e.trim().normalize("NFC")).slice(0,1).join("");if(!t)throw Error("[api] invalid hanja char");let r=await fetch("/api/admin/local/hanja/not-inmyong",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify({char:t})});if(!r.ok){let e=await r.text();throw Error("[api] mark not-inmyong failed: ".concat(r.status," ").concat(e))}}async function u(e){let t=e.trim().normalize("NFC");if(!t)throw Error("[api] invalid nameHangul");let r=await fetch("/api/admin/local/blacklist-word",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify({nameHangul:t})});if(!r.ok){let e=await r.text();throw Error("[api] blacklist update failed: ".concat(r.status," ").concat(e))}return{inserted:!0===(await r.json()).inserted}}r.d(t,{le:function(){return o},mS:function(){return a},o4:function(){return i},oj:function(){return s},yF:function(){return l},zT:function(){return u}})},4522:function(e,t,r){"use strict";r.d(t,{T:function(){return l}});var n=r(8321),a=r(4452);let i={birth:{calendar:"SOLAR",date:""},surnameHanja:"",gender:"UNISEX"},s=(0,a.FL)(()=>window.sessionStorage);function o(e){return Number.isFinite(e)?Math.round(2*Math.max(0,Math.min(5,e)))/2:0}let l=(0,n.U)()((0,a.tJ)(e=>({input:i,surnameHangul:"",summary:null,results:[],hasHydrated:!1,setHasHydrated:t=>e({hasHydrated:t}),setInput:t=>e({input:t}),setSurnameHangul:t=>e({surnameHangul:t}),setSummary:t=>e({summary:t}),setResults:t=>e({results:t.slice(0,20).map((e,t)=>({...e,rank:Number.isFinite(e.rank)?e.rank:t+1,sajuScore5:o(e.sajuScore5),soundScore5:o(e.soundScore5),engineScore01:Math.max(0,Math.min(1,e.engineScore01)),why:Array.isArray(e.why)&&e.why.length>0?e.why:["추천 이유를 계산 중입니다."]}))}),reset:()=>e({input:i,surnameHangul:"",summary:null,results:[]})}),{name:"namefit-toss-premium-store-v1",storage:s,partialize:e=>({input:e.input,surnameHangul:e.surnameHangul,summary:e.summary,results:e.results}),onRehydrateStorage:()=>(e,t)=>{t&&console.error("[store] premium store rehydrate failed",t),null==e||e.setHasHydrated(!0)}}))},1695:function(e,t,r){"use strict";var n=r(1219);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},4452:function(e,t,r){"use strict";function n(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var n;let a=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),i=null!=(n=r.getItem(e))?n:null;return i instanceof Promise?i.then(a):a(i)},setItem:(e,n)=>r.setItem(e,JSON.stringify(n,null==t?void 0:t.replacer)),removeItem:e=>r.removeItem(e)}}r.d(t,{FL:function(){return n},tJ:function(){return i}});let a=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>a(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>a(t)(e)}}},i=(e,t)=>(r,i,s)=>{let o,l={storage:n(()=>window.localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},u=!1,c=0,d=new Set,m=new Set,f=l.storage;if(!f)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...e)},i,s);let p=()=>{let e=l.partialize({...i()});return f.setItem(l.name,{state:e,version:l.version})},h=s.setState;s.setState=(e,t)=>(h(e,t),p());let y=e((...e)=>(r(...e),p()),i,s);s.getInitialState=()=>y;let g=()=>{var e,t;if(!f)return;let n=++c;u=!1,d.forEach(e=>{var t;return e(null!=(t=i())?t:y)});let s=(null==(t=l.onRehydrateStorage)?void 0:t.call(l,null!=(e=i())?e:y))||void 0;return a(f.getItem.bind(f))(l.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===l.version)return[!1,e.state];if(l.migrate){let t=l.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;if(n!==c)return;let[a,s]=e;if(r(o=l.merge(s,null!=(t=i())?t:y),!0),a)return p()}).then(()=>{n===c&&(null==s||s(o,void 0),o=i(),u=!0,m.forEach(e=>e(o)))}).catch(e=>{n===c&&(null==s||s(void 0,e))})};return s.persist={setOptions:e=>{l={...l,...e},e.storage&&(f=e.storage)},clearStorage:()=>{null==f||f.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>g(),hasHydrated:()=>u,onHydrate:e=>(d.add(e),()=>{d.delete(e)}),onFinishHydration:e=>(m.add(e),()=>{m.delete(e)})},l.skipHydration||g(),o||y}},8321:function(e,t,r){"use strict";r.d(t,{U:function(){return l}});var n=r(7653);let a=e=>{let t;let r=new Set,n=(e,n)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=n?n:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,i={setState:n,getState:a,getInitialState:()=>s,subscribe:e=>(r.add(e),()=>r.delete(e))},s=t=e(n,a,i);return i},i=e=>e?a(e):a,s=e=>e,o=e=>{let t=i(e),r=e=>(function(e,t=s){let r=n.useSyncExternalStore(e.subscribe,n.useCallback(()=>t(e.getState()),[e,t]),n.useCallback(()=>t(e.getInitialState()),[e,t]));return n.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},l=e=>e?o(e):o}},function(e){e.O(0,[146,293,528,744],function(){return e(e.s=8396)}),_N_E=e.O()}]);